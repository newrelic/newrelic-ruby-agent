instrumentation_methods :chain, :prepend

# Tests latest Tilt version
if RUBY_VERSION >= '3.0.0'
  gemfile <<-RB
    gem 'tilt'
    gem 'webrick'
    gem 'haml'
  RB
else
  gemfile <<-RB
    gem 'tilt'
    gem 'haml'
  RB
end

# Add last release for each major version here
tilt_versions = ['1.4.1']

tilt_versions.each do |version|
  if RUBY_VERSION >= '3.0.0'
    gemfile <<-RB
      gem 'tilt', '#{version}'
      gem 'webrick'
      gem 'haml'
    RB
  else
    gemfile <<-RB
      gem 'tilt', '#{version}'
      gem 'haml'
    RB
  end
end
