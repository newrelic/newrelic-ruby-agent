---
title: Ruby agent configuration
tags:
  - Agents
  - Ruby agent
  - Configuration
metaDescription: 'APM for Ruby: how to configure the Ruby agent, including editing the config file and setting environment variables.'
redirects:
  - /docs/agents/ruby-agent/configuration/ruby-agent-configuration
  - /docs/ruby/ruby-agent-configuration
  - /docs/agents/ruby-agent/installation-and-configuration/ruby-agent-configuration
  - /docs/agents/ruby-agent/installation-configuration/ruby-agent-configuration
---

<CONTRIBUTOR_NOTE>
  This file is automatically generated from values defined in `lib/new_relic/agent/configuration/default_source.rb`.
  All changes should be made directly to `default_source.rb.`
  Submit PRs or raise issues at: https://github.com/newrelic/newrelic-ruby-agent
</CONTRIBUTOR_NOTE>

You can configure the New Relic Ruby agent with settings in a configuration file, environment variables, or programmatically with server-side configuration. This document summarizes the configuration options available for the Ruby agent.

If the default value for a configuration option is `(Dynamic)`, this means the Ruby agent calculates the default at runtime. The value for the config setting defaults to the value of another setting as appropriate.

## Configuration methods and precedence [#Options]

The primary (default) method to configure the Ruby agent is via the configuration file (`newrelic.yml`) in the `config` subdirectory. To set configuration values using environment variables:

1. Add the prefix `NEW_RELIC_` to the setting's name.
2. Replace any periods `.` with underscores `_`.

You can also configure a few values in the UI via [server-side configuration](/docs/agents/manage-apm-agents/configuration/server-side-agent-configuration).

The Ruby agent follows this order of precedence for configuration:

1. Environment variables
2. Server-side configuration
3. Configuration file (`newrelic.yml`)
4. Default configuration settings

In other words, environment variables override all other configuration settings and info, server-side configuration overrides the configuration file and default config settings, and so on.

## View and edit config file options [#Edit]

The Ruby agent's `newrelic.yml` is a standard YAML configuration file. It typically includes a `Defaults` section at the top, plus sections below for each application environment; for example, `Development`, `Testing`, and `Production`.

The Ruby agent determines which section of the `newrelic.yml` config file to read from by looking at certain environment variables to derive the application's environment. This can be useful, for example, when you want to use `info` for the `log_level` config setting in your production environment, and you want more verbose `log_level` config settings (such as `debug` in your development environment.

Here is an example `newrelic.yml` config file:

```yaml
common: &default_settings
  license_key: 'YOUR_LICENSE_KEY'
  app_name: 'My Application Name'
production:
  <<: *default_settings
  log_level: info
development:
  <<: *default_settings
  log_level: debug
```

For non-Rails apps, the Ruby agent looks for the following environment variables, in this order, to determine the application environment:

1. `NEW_RELIC_ENV`
2. `RUBY_ENV`
3. `RAILS_ENV`
4. `APP_ENV`
5. `RACK_ENV`

If the Ruby agent does not detect values for any of those environment variables, it will default the application environment to `development` and read from the `development` section of the `newrelic.yml` config file.

When running the Ruby agent in a Rails app, the agent first looks for the `NEW_RELIC_ENV` environment variable to determine the application environment and which section of the `newrelic.yml` to use. If `NEW_RELIC_ENV` is not present, the agent uses the Rails environment (`RAILS_ENV` or `RAILS.env`, depending on the version of Rails) .

When you edit the config file, be sure to:

* Indent only with two spaces.
* Indent only where relevant, in stanzas such as **`error_collector`**.

If you do not indent correctly, the agent may throw an `Unable to parse configuration file` error on startup.

To view the most current list of available Ruby agent configuration options, use the `rake newrelic:config:docs` command. This document describes the most common options.

## Update the config file [#Updates]

This documentation applies to the Ruby agent's latest release. For details on earlier versions, refer to the comments in `newrelic.yml` itself.

To update `newrelic.yml` file after a new release, use the template in the base directory of the agent gem. When you update to new gem versions, examine or diff `config/newrelic.yml` and `newrelic.yml` in the [installation directory](/docs/agents/manage-apm-agents/troubleshooting/find-agent-root-directory#ruby-agent) to take advantage of new configuration options.

<Callout variant="important">
  Updating the gem does not automatically update `config/newrelic.yml`.
</Callout>


## General [#general]

These settings are available for agent configuration. Some settings depend on your New Relic subscription level.

<CollapserGroup>

  <Collapser id="agent_enabled" title="agent_enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_AGENT_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, allows the Ruby agent to run.
  </Collapser>

  <Collapser id="app_name" title="app_name">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`(Dynamic)`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APP_NAME`</td></tr>
      </tbody>
    </table>

  Specify the [application name](/docs/apm/new-relic-apm/installation-configuration/name-your-application) used to aggregate data in the New Relic UI. To report data to [multiple apps at the same time](/docs/apm/new-relic-apm/installation-configuration/using-multiple-names-app), specify a list of names separated by a semicolon `;`. For example, `MyApp` or `MyStagingApp;Instance1`.
  </Collapser>

  <Collapser id="license_key" title="license_key">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_LICENSE_KEY`</td></tr>
      </tbody>
    </table>

  Your New Relic <InlinePopover type="licenseKey" />.
  </Collapser>

  <Collapser id="log_level" title="log_level">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"info"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_LOG_LEVEL`</td></tr>
      </tbody>
    </table>

  Sets the level of detail of log messages. Possible log levels, in increasing verbosity, are: `error`, `warn`, `info` or `debug`.
  </Collapser>

  <Collapser id="active_support_custom_events_names" title="active_support_custom_events_names">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ACTIVE_SUPPORT_CUSTOM_EVENTS_NAMES`</td></tr>
      </tbody>
    </table>

  An array of ActiveSupport custom event names to subscribe to and instrument. For example,
  - one.custom.event
  - another.event
  - a.third.event

  </Collapser>

  <Collapser id="api_key" title="api_key">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_API_KEY`</td></tr>
      </tbody>
    </table>

  Your New Relic <InlinePopover type="userKey" />. Required when using the New Relic REST API v2 to record deployments using the `newrelic deployments` command.
  </Collapser>

  <Collapser id="backport_fast_active_record_connection_lookup" title="backport_fast_active_record_connection_lookup">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_BACKPORT_FAST_ACTIVE_RECORD_CONNECTION_LOOKUP`</td></tr>
      </tbody>
    </table>

  Backports the faster ActiveRecord connection lookup introduced in Rails 6, which improves agent performance when instrumenting ActiveRecord. Note that this setting may not be compatible with other gems that patch ActiveRecord.
  </Collapser>

  <Collapser id="ca_bundle_path" title="ca_bundle_path">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`nil`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CA_BUNDLE_PATH`</td></tr>
      </tbody>
    </table>

  Manual override for the path to your local CA bundle. This CA bundle will be used to validate the SSL certificate presented by New Relic's data collection service.
  </Collapser>

  <Collapser id="capture_memcache_keys" title="capture_memcache_keys">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CAPTURE_MEMCACHE_KEYS`</td></tr>
      </tbody>
    </table>

  Enable or disable the capture of memcache keys from transaction traces.
  </Collapser>

  <Collapser id="capture_params" title="capture_params">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CAPTURE_PARAMS`</td></tr>
      </tbody>
    </table>

  When `true`, the agent captures HTTP request parameters and attaches them to transaction traces, traced errors, and [`TransactionError` events](/attribute-dictionary?attribute_name=&events_tids%5B%5D=8241).

    <Callout variant="caution">
      When using the `capture_params` setting, the Ruby agent will not attempt to filter secret information. `Recommendation:` To filter secret information from request parameters, use the [`attributes.include` setting](/docs/agents/ruby-agent/attributes/enable-disable-attributes-ruby) instead. For more information, see the <a href="/docs/agents/ruby-agent/attributes/ruby-attribute-examples#ex_req_params">Ruby attribute examples</a>.
    </Callout>

  </Collapser>

  <Collapser id="clear_transaction_state_after_fork" title="clear_transaction_state_after_fork">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CLEAR_TRANSACTION_STATE_AFTER_FORK`</td></tr>
      </tbody>
    </table>

  If `true`, the agent will clear `Tracer::State` in `Agent.drop_buffered_data`.
  </Collapser>

  <Collapser id="config_path" title="config_path">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`(Dynamic)`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CONFIG_PATH`</td></tr>
      </tbody>
    </table>

  Path to `newrelic.yml`. If undefined, the agent checks the following directories (in order):
    * `config/newrelic.yml`
    * `newrelic.yml`
    * `$HOME/.newrelic/newrelic.yml`
    * `$HOME/newrelic.yml`

  </Collapser>

  <Collapser id="exclude_newrelic_header" title="exclude_newrelic_header">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_EXCLUDE_NEWRELIC_HEADER`</td></tr>
      </tbody>
    </table>

  Allows newrelic distributed tracing headers to be suppressed on outbound requests.
  </Collapser>

  <Collapser id="force_install_exit_handler" title="force_install_exit_handler">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_FORCE_INSTALL_EXIT_HANDLER`</td></tr>
      </tbody>
    </table>

  Forces the exit handler that sends all cached data to collector before shutting down to be installed regardless of detecting scenarios where it generally should not be. Known use-case for this option is where Sinatra is running as an embedded service within another framework and the agent is detecting the Sinatra app and skipping the `at_exit` handler as a result. Sinatra classically runs the entire application in an `at_exit` block and would otherwise misbehave if the Agent's `at_exit` handler was also installed in those circumstances. Note: `send_data_on_exit` should also be set to `true` in  tandem with this setting.
  </Collapser>

  <Collapser id="high_security" title="high_security">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_HIGH_SECURITY`</td></tr>
      </tbody>
    </table>

  If `true`, enables [high security mode](/docs/accounts-partnerships/accounts/security/high-security). Ensure you understand the implications of high security mode before enabling this setting.
  </Collapser>

  <Collapser id="labels" title="labels">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_LABELS`</td></tr>
      </tbody>
    </table>

  A dictionary of [label names](/docs/data-analysis/user-interface-functions/labels-categories-organize-your-apps-servers) and values that will be applied to the data sent from this agent. May also be expressed as a semicolon-delimited `;` string of colon-separated `:` pairs. For example, `Server:One;Data Center:Primary`.
  </Collapser>

  <Collapser id="log_file_name" title="log_file_name">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"newrelic_agent.log"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_LOG_FILE_NAME`</td></tr>
      </tbody>
    </table>

  Defines a name for the log file.
  </Collapser>

  <Collapser id="log_file_path" title="log_file_path">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"log/"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_LOG_FILE_PATH`</td></tr>
      </tbody>
    </table>

  Defines a path to the agent log file, excluding the filename.
  </Collapser>

  <Collapser id="marshaller" title="marshaller">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"json"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_MARSHALLER`</td></tr>
      </tbody>
    </table>

  Specifies a marshaller for transmitting data to the New Relic [collector](/docs/apm/new-relic-apm/getting-started/glossary#collector). Currently `json` is the only valid value for this setting.
  </Collapser>

  <Collapser id="monitor_mode" title="monitor_mode">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_MONITOR_MODE`</td></tr>
      </tbody>
    </table>

  When `true`, the agent transmits data about your app to the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector).
  </Collapser>

  <Collapser id="prepend_active_record_instrumentation" title="prepend_active_record_instrumentation">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_PREPEND_ACTIVE_RECORD_INSTRUMENTATION`</td></tr>
      </tbody>
    </table>

  If `true`, uses `Module#prepend` rather than `alias_method` for ActiveRecord instrumentation.
  </Collapser>

  <Collapser id="proxy_host" title="proxy_host">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`nil`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_PROXY_HOST`</td></tr>
      </tbody>
    </table>

  Defines a host for communicating with the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector) via a proxy server.
  </Collapser>

  <Collapser id="proxy_pass" title="proxy_pass">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`nil`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_PROXY_PASS`</td></tr>
      </tbody>
    </table>

  Defines a password for communicating with the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector) via a proxy server.
  </Collapser>

  <Collapser id="proxy_port" title="proxy_port">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`8080`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_PROXY_PORT`</td></tr>
      </tbody>
    </table>

  Defines a port for communicating with the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector) via a proxy server.
  </Collapser>

  <Collapser id="proxy_user" title="proxy_user">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`nil`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_PROXY_USER`</td></tr>
      </tbody>
    </table>

  Defines a user for communicating with the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector) via a proxy server.
  </Collapser>

  <Collapser id="security_policies_token" title="security_policies_token">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SECURITY_POLICIES_TOKEN`</td></tr>
      </tbody>
    </table>

  Applies Language Agent Security Policy settings.
  </Collapser>

  <Collapser id="send_data_on_exit" title="send_data_on_exit">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SEND_DATA_ON_EXIT`</td></tr>
      </tbody>
    </table>

  If `true`, enables the exit handler that sends data to the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector) before shutting down.
  </Collapser>

  <Collapser id="sync_startup" title="sync_startup">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SYNC_STARTUP`</td></tr>
      </tbody>
    </table>

  When set to `true`, forces a synchronous connection to the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector) during application startup. For very short-lived processes, this helps ensure the New Relic agent has time to report.
  </Collapser>

  <Collapser id="timeout" title="timeout">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`120`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TIMEOUT`</td></tr>
      </tbody>
    </table>

  Defines the maximum number of seconds the agent should spend attempting to connect to the collector.
  </Collapser>

  <Collapser id="defer_rails_initialization" title="defer_rails_initialization">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DEFER_RAILS_INITIALIZATION`</td></tr>
      </tbody>
    </table>

              If `true`, when the agent is in an application using Ruby on Rails, it will start after `config/initializers` run.

            <Callout variant="caution">
              This option may only be set by environment variable.
            </Callout>

  </Collapser>

</CollapserGroup>

## Transaction Tracer [#transaction-tracer]

The [transaction traces](/docs/apm/traces/transaction-traces/transaction-traces) feature collects detailed information from a selection of transactions, including a summary of the calling sequence, a breakdown of time spent, and a list of SQL queries and their query plans (on mysql and postgresql). Available features depend on your New Relic subscription level.

<CollapserGroup>

  <Collapser id="transaction_tracer-enabled" title="transaction_tracer.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables collection of [transaction traces](/docs/apm/traces/transaction-traces/transaction-traces).
  </Collapser>

  <Collapser id="transaction_tracer-explain_enabled" title="transaction_tracer.explain_enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_EXPLAIN_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables the collection of explain plans in transaction traces. This setting will also apply to explain plans in slow SQL traces if [`slow_sql.explain_enabled`](#slow_sql-explain_enabled) is not set separately.
  </Collapser>

  <Collapser id="transaction_tracer-explain_threshold" title="transaction_tracer.explain_threshold">
    <table>
      <tbody>
        <tr><th>Type</th><td>Float</td></tr>
        <tr><th>Default</th><td>`0.5`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_EXPLAIN_THRESHOLD`</td></tr>
      </tbody>
    </table>

  Threshold (in seconds) above which the agent will collect explain plans. Relevant only when [`explain_enabled`](#transaction_tracer.explain_enabled) is true.
  </Collapser>

  <Collapser id="transaction_tracer-limit_segments" title="transaction_tracer.limit_segments">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`4000`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_LIMIT_SEGMENTS`</td></tr>
      </tbody>
    </table>

  Maximum number of transaction trace nodes to record in a single transaction trace.
  </Collapser>

  <Collapser id="transaction_tracer-record_redis_arguments" title="transaction_tracer.record_redis_arguments">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_RECORD_REDIS_ARGUMENTS`</td></tr>
      </tbody>
    </table>

  If `true`, the agent records Redis command arguments in transaction traces.
  </Collapser>

  <Collapser id="transaction_tracer-record_sql" title="transaction_tracer.record_sql">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"obfuscated"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_RECORD_SQL`</td></tr>
      </tbody>
    </table>

  Obfuscation level for SQL queries reported in transaction trace nodes.

  By default, this is set to `obfuscated`, which strips out the numeric and string literals.

  - If you do not want the agent to capture query information, set this to `none`.
  - If you want the agent to capture all query information in its original form, set this to `raw`.
  - When you enable [high security mode](/docs/agents/manage-apm-agents/configuration/high-security-mode), this is automatically set to `obfuscated`.
  </Collapser>

  <Collapser id="transaction_tracer-stack_trace_threshold" title="transaction_tracer.stack_trace_threshold">
    <table>
      <tbody>
        <tr><th>Type</th><td>Float</td></tr>
        <tr><th>Default</th><td>`0.5`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_STACK_TRACE_THRESHOLD`</td></tr>
      </tbody>
    </table>

  Specify a threshold in seconds. The agent includes stack traces in transaction trace nodes when the stack trace duration exceeds this threshold.
  </Collapser>

  <Collapser id="transaction_tracer-transaction_threshold" title="transaction_tracer.transaction_threshold">
    <table>
      <tbody>
        <tr><th>Type</th><td>Float</td></tr>
        <tr><th>Default</th><td>`(Dynamic)`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_TRANSACTION_THRESHOLD`</td></tr>
      </tbody>
    </table>

  Specify a threshold in seconds. Transactions with a duration longer than this threshold are eligible for transaction traces. Specify a float value or the string `apdex_f`.
  </Collapser>

</CollapserGroup>

## Error Collector [#error-collector]

The agent collects and reports all uncaught exceptions by default. These configuration options allow you to customize the error collection.

For information on ignored and expected errors, [see this page on Error Analytics in APM](/docs/agents/manage-apm-agents/agent-data/manage-errors-apm-collect-ignore-or-mark-expected/). To set expected errors via the `NewRelic::Agent.notice_error` Ruby method, [consult the Ruby Agent API](/docs/agents/ruby-agent/api-guides/sending-handled-errors-new-relic/).

<CollapserGroup>

  <Collapser id="error_collector-ignore_classes" title="error_collector.ignore_classes">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`["ActionController::RoutingError", "Sinatra::NotFound"]`</td></tr>
        <tr><th>Environ variable</th><td>`None`</td></tr>
      </tbody>
    </table>

  A list of error classes that the agent should ignore.

  <Callout variant="caution">
    This option can't be set via environment variable.
  </Callout>

  </Collapser>

  <Collapser id="error_collector-capture_events" title="error_collector.capture_events">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_CAPTURE_EVENTS`</td></tr>
      </tbody>
    </table>

  If `true`, the agent collects [`TransactionError` events](/docs/insights/new-relic-insights/decorating-events/error-event-default-attributes-insights).
  </Collapser>

  <Collapser id="error_collector-enabled" title="error_collector.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures traced errors and error count metrics.
  </Collapser>

  <Collapser id="error_collector-expected_classes" title="error_collector.expected_classes">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`None`</td></tr>
      </tbody>
    </table>

  A list of error classes that the agent should treat as expected.

  <Callout variant="caution">
    This option can't be set via environment variable.
  </Callout>

  </Collapser>

  <Collapser id="error_collector-expected_messages" title="error_collector.expected_messages">
    <table>
      <tbody>
        <tr><th>Type</th><td>Hash</td></tr>
        <tr><th>Default</th><td>`{}`</td></tr>
        <tr><th>Environ variable</th><td>`None`</td></tr>
      </tbody>
    </table>

  A map of error classes to a list of messages. When an error of one of the classes specified here occurs, if its error message contains one of the strings corresponding to it here, that error will be treated as expected.

  <Callout variant="caution">
    This option can't be set via environment variable.
  </Callout>

  </Collapser>

  <Collapser id="error_collector-expected_status_codes" title="error_collector.expected_status_codes">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_EXPECTED_STATUS_CODES`</td></tr>
      </tbody>
    </table>

  A comma separated list of status codes, possibly including ranges. Errors associated with these status codes, where applicable, will be treated as expected.
  </Collapser>

  <Collapser id="error_collector-ignore_messages" title="error_collector.ignore_messages">
    <table>
      <tbody>
        <tr><th>Type</th><td>Hash</td></tr>
        <tr><th>Default</th><td>`{}`</td></tr>
        <tr><th>Environ variable</th><td>`None`</td></tr>
      </tbody>
    </table>

  A map of error classes to a list of messages. When an error of one of the classes specified here occurs, if its error message contains one of the strings corresponding to it here, that error will be ignored.

  <Callout variant="caution">
    This option can't be set via environment variable.
  </Callout>

  </Collapser>

  <Collapser id="error_collector-ignore_status_codes" title="error_collector.ignore_status_codes">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_IGNORE_STATUS_CODES`</td></tr>
      </tbody>
    </table>

  A comma separated list of status codes, possibly including ranges. Errors associated with these status codes, where applicable, will be ignored.
  </Collapser>

  <Collapser id="error_collector-max_backtrace_frames" title="error_collector.max_backtrace_frames">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`50`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_MAX_BACKTRACE_FRAMES`</td></tr>
      </tbody>
    </table>

  Defines the maximum number of frames in an error backtrace. Backtraces over this amount are truncated at the beginning and end.
  </Collapser>

  <Collapser id="error_collector-max_event_samples_stored" title="error_collector.max_event_samples_stored">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`100`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_MAX_EVENT_SAMPLES_STORED`</td></tr>
      </tbody>
    </table>

  Defines the maximum number of [`TransactionError` events](/docs/insights/new-relic-insights/decorating-events/error-event-default-attributes-insights) reported per harvest cycle.
  </Collapser>

</CollapserGroup>

## Browser Monitoring [#browser-monitoring]

The browser monitoring [page load timing](/docs/browser/new-relic-browser/page-load-timing/page-load-timing-process) feature (sometimes referred to as real user monitoring or RUM) gives you insight into the performance real users are experiencing with your website. This is accomplished by measuring the time it takes for your users' browsers to download and render your web pages by injecting a small amount of JavaScript code into the header and footer of each page.

<CollapserGroup>

  <Collapser id="browser_monitoring-auto_instrument" title="browser_monitoring.auto_instrument">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_BROWSER_MONITORING_AUTO_INSTRUMENT`</td></tr>
      </tbody>
    </table>

  If `true`, enables [auto-injection](/docs/browser/new-relic-browser/installation-configuration/adding-apps-new-relic-browser#select-apm-app) of the JavaScript header for page load timing (sometimes referred to as real user monitoring or RUM).
  </Collapser>

</CollapserGroup>

## Transaction Events [#transaction-events]



<CollapserGroup>

  <Collapser id="transaction_events-enabled" title="transaction_events.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_EVENTS_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables transaction event sampling.
  </Collapser>

  <Collapser id="transaction_events-max_samples_stored" title="transaction_events.max_samples_stored">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`1200`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_EVENTS_MAX_SAMPLES_STORED`</td></tr>
      </tbody>
    </table>

  Defines the maximum number of transaction events reported from a single harvest.
  </Collapser>

</CollapserGroup>

## Application Logging [#application-logging]

The Ruby agent supports [APM logs in context](/docs/apm/new-relic-apm/getting-started/get-started-logs-context). For some tips on configuring logs for the Ruby agent, see [Configure Ruby logs in context](/docs/logs/logs-context/configure-logs-context-ruby).

Available logging-related config options include:

<CollapserGroup>

  <Collapser id="application_logging-enabled" title="application_logging.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APPLICATION_LOGGING_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables log decoration and the collection of log events and metrics.
  </Collapser>

  <Collapser id="application_logging-forwarding-enabled" title="application_logging.forwarding.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APPLICATION_LOGGING_FORWARDING_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures log records emitted by your application.
  </Collapser>

  <Collapser id="application_logging-forwarding-log_level" title="application_logging.forwarding.log_level">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"debug"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APPLICATION_LOGGING_FORWARDING_LOG_LEVEL`</td></tr>
      </tbody>
    </table>

  Sets the minimum level a log event must have to be forwarded to New Relic.

This is based on the integer values of Ruby's `Logger::Severity` constants: https://github.com/ruby/ruby/blob/master/lib/logger/severity.rb

The intention is to forward logs with the level given to the configuration, as well as any logs with a higher level of severity.

For example, setting this value to "debug" will forward all log events to New Relic. Setting this value to "error" will only forward log events with the levels "error", "fatal", and "unknown".

Valid values (ordered lowest to highest):
  * "debug"
  * "info"
  * "warn"
  * "error"
  * "fatal"
  * "unknown"

  </Collapser>

  <Collapser id="application_logging-forwarding-custom_attributes" title="application_logging.forwarding.custom_attributes">
    <table>
      <tbody>
        <tr><th>Type</th><td>Hash</td></tr>
        <tr><th>Default</th><td>`{}`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APPLICATION_LOGGING_FORWARDING_CUSTOM_ATTRIBUTES`</td></tr>
      </tbody>
    </table>

  A hash with key/value pairs to add as custom attributes to all log events forwarded to New Relic. If sending using an environment variable, the value must be formatted like: "key1=value1,key2=value2"
  </Collapser>

  <Collapser id="application_logging-forwarding-max_samples_stored" title="application_logging.forwarding.max_samples_stored">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`10000`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APPLICATION_LOGGING_FORWARDING_MAX_SAMPLES_STORED`</td></tr>
      </tbody>
    </table>

  Defines the maximum number of log records to buffer in memory at a time.
  </Collapser>

  <Collapser id="application_logging-local_decorating-enabled" title="application_logging.local_decorating.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APPLICATION_LOGGING_LOCAL_DECORATING_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent decorates logs with metadata to link to entities, hosts, traces, and spans.
  </Collapser>

  <Collapser id="application_logging-metrics-enabled" title="application_logging.metrics.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_APPLICATION_LOGGING_METRICS_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures metrics related to logging for your application.
  </Collapser>

</CollapserGroup>

## Attributes [#attributes]

[Attributes](/docs/features/agent-attributes) are key-value pairs containing information that determines the properties of an event or transaction. These key-value pairs can be viewed within transaction traces in APM, traced errors in APM, transaction events in dashboards, and page views in dashboards. You can customize exactly which attributes will be sent to each of these destinations

<CollapserGroup>

  <Collapser id="attributes-enabled" title="attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables capture of attributes for all destinations.
  </Collapser>

  <Collapser id="attributes-exclude" title="attributes.exclude">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ATTRIBUTES_EXCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to exclude from all destinations. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="attributes-include" title="attributes.include">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ATTRIBUTES_INCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to include in all destinations. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="browser_monitoring-attributes-enabled" title="browser_monitoring.attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures attributes from browser monitoring.
  </Collapser>

  <Collapser id="browser_monitoring-attributes-exclude" title="browser_monitoring.attributes.exclude">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_EXCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to exclude from browser monitoring. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="browser_monitoring-attributes-include" title="browser_monitoring.attributes.include">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_BROWSER_MONITORING_ATTRIBUTES_INCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to include in browser monitoring. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="error_collector-attributes-enabled" title="error_collector.attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures attributes from error collection.
  </Collapser>

  <Collapser id="error_collector-attributes-exclude" title="error_collector.attributes.exclude">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_EXCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to exclude from error collection. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="error_collector-attributes-include" title="error_collector.attributes.include">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ERROR_COLLECTOR_ATTRIBUTES_INCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to include in error collection. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="span_events-attributes-enabled" title="span_events.attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures attributes on span events.
  </Collapser>

  <Collapser id="span_events-attributes-exclude" title="span_events.attributes.exclude">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_EXCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to exclude from span events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="span_events-attributes-include" title="span_events.attributes.include">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SPAN_EVENTS_ATTRIBUTES_INCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to include on span events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="transaction_events-attributes-enabled" title="transaction_events.attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures attributes from transaction events.
  </Collapser>

  <Collapser id="transaction_events-attributes-exclude" title="transaction_events.attributes.exclude">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_EXCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to exclude from transaction events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="transaction_events-attributes-include" title="transaction_events.attributes.include">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_EVENTS_ATTRIBUTES_INCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to include in transaction events. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="transaction_segments-attributes-enabled" title="transaction_segments.attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures attributes on transaction segments.
  </Collapser>

  <Collapser id="transaction_segments-attributes-exclude" title="transaction_segments.attributes.exclude">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_EXCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to exclude from transaction segments. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="transaction_segments-attributes-include" title="transaction_segments.attributes.include">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_SEGMENTS_ATTRIBUTES_INCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to include on transaction segments. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="transaction_tracer-attributes-enabled" title="transaction_tracer.attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures attributes from transaction traces.
  </Collapser>

  <Collapser id="transaction_tracer-attributes-exclude" title="transaction_tracer.attributes.exclude">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_EXCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to exclude from transaction traces. Allows `*` as wildcard at end.
  </Collapser>

  <Collapser id="transaction_tracer-attributes-include" title="transaction_tracer.attributes.include">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_TRANSACTION_TRACER_ATTRIBUTES_INCLUDE`</td></tr>
      </tbody>
    </table>

  Prefix of attributes to include in transaction traces. Allows `*` as wildcard at end.
  </Collapser>

</CollapserGroup>

## Audit Log [#audit-log]



<CollapserGroup>

  <Collapser id="audit_log-enabled" title="audit_log.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_AUDIT_LOG_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables an audit log which logs communications with the New Relic [collector](/docs/using-new-relic/welcome-new-relic/get-started/glossary/#collector).
  </Collapser>

  <Collapser id="audit_log-endpoints" title="audit_log.endpoints">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[".*"]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_AUDIT_LOG_ENDPOINTS`</td></tr>
      </tbody>
    </table>

  List of allowed endpoints to include in audit log.
  </Collapser>

  <Collapser id="audit_log-path" title="audit_log.path">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`log/newrelic_audit.log`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_AUDIT_LOG_PATH`</td></tr>
      </tbody>
    </table>

  Specifies a path to the audit log file (including the filename).
  </Collapser>

</CollapserGroup>

## Autostart [#autostart]



<CollapserGroup>

  <Collapser id="autostart-denylisted_constants" title="autostart.denylisted_constants">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"Rails::Console"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_AUTOSTART_DENYLISTED_CONSTANTS`</td></tr>
      </tbody>
    </table>

  Specify a list of constants that should prevent the agent from starting automatically. Separate individual constants with a comma `,`. For example, `"Rails::Console,UninstrumentedBackgroundJob"`.
  </Collapser>

  <Collapser id="autostart-denylisted_executables" title="autostart.denylisted_executables">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"irb,rspec"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_AUTOSTART_DENYLISTED_EXECUTABLES`</td></tr>
      </tbody>
    </table>

  Defines a comma-delimited list of executables that the agent should not instrument. For example, `"rake,my_ruby_script.rb"`.
  </Collapser>

  <Collapser id="autostart-denylisted_rake_tasks" title="autostart.denylisted_rake_tasks">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"about,assets:clean,assets:clobber,assets:environment,assets:precompile,assets:precompile:all,db:create,db:drop,db:fixtures:load,db:migrate,db:migrate:status,db:rollback,db:schema:cache:clear,db:schema:cache:dump,db:schema:dump,db:schema:load,db:seed,db:setup,db:structure:dump,db:version,doc:app,log:clear,middleware,notes,notes:custom,rails:template,rails:update,routes,secret,spec,spec:features,spec:requests,spec:controllers,spec:helpers,spec:models,spec:views,spec:routing,spec:rcov,stats,test,test:all,test:all:db,test:recent,test:single,test:uncommitted,time:zones:all,tmp:clear,tmp:create,webpacker:compile"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_AUTOSTART_DENYLISTED_RAKE_TASKS`</td></tr>
      </tbody>
    </table>

  Defines a comma-delimited list of Rake tasks that the agent should not instrument. For example, `"assets:precompile,db:migrate"`.
  </Collapser>

</CollapserGroup>

## Code Level Metrics [#code-level-metrics]



<CollapserGroup>

  <Collapser id="code_level_metrics-enabled" title="code_level_metrics.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CODE_LEVEL_METRICS_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent will report source code level metrics for traced methods.
see: https://docs.newrelic.com/docs/apm/agents/ruby-agent/features/ruby-codestream-integration/
  </Collapser>

</CollapserGroup>

## Cross Application Tracer [#cross-application-tracer]



<CollapserGroup>

  <Collapser id="cross_application_tracer-enabled" title="cross_application_tracer.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CROSS_APPLICATION_TRACER_ENABLED`</td></tr>
      </tbody>
    </table>

  <b>DEPRECATED</b> Please see: [distributed_tracing-enabled](/docs/agents/ruby-agent/configuration/ruby-agent-configuration#distributed_tracing-enabled).

If `true`, enables [cross-application tracing](/docs/agents/ruby-agent/features/cross-application-tracing-ruby/) when `distributed_tracing.enabled` is set to `false`.
  </Collapser>

</CollapserGroup>

## Custom Attributes [#custom-attributes]



<CollapserGroup>

  <Collapser id="custom_attributes-enabled" title="custom_attributes.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CUSTOM_ATTRIBUTES_ENABLED`</td></tr>
      </tbody>
    </table>

  If `false`, custom attributes will not be sent on events.
  </Collapser>

</CollapserGroup>

## Custom Events [#custom-events]



<CollapserGroup>

  <Collapser id="custom_insights_events-enabled" title="custom_insights_events.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures [custom events](/docs/insights/new-relic-insights/adding-querying-data/inserting-custom-events-new-relic-apm-agents).
  </Collapser>

  <Collapser id="custom_insights_events-max_samples_stored" title="custom_insights_events.max_samples_stored">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`3000`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_CUSTOM_INSIGHTS_EVENTS_MAX_SAMPLES_STORED`</td></tr>
      </tbody>
    </table>

  Specify a maximum number of custom events to buffer in memory at a time.
  </Collapser>

</CollapserGroup>

## Datastore Tracer [#datastore-tracer]



<CollapserGroup>

  <Collapser id="datastore_tracer-database_name_reporting-enabled" title="datastore_tracer.database_name_reporting.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DATASTORE_TRACER_DATABASE_NAME_REPORTING_ENABLED`</td></tr>
      </tbody>
    </table>

  If `false`, the agent will not add `database_name` parameter to transaction or slow sql traces.
  </Collapser>

  <Collapser id="datastore_tracer-instance_reporting-enabled" title="datastore_tracer.instance_reporting.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DATASTORE_TRACER_INSTANCE_REPORTING_ENABLED`</td></tr>
      </tbody>
    </table>

  If `false`, the agent will not report datastore instance metrics, nor add `host` or `port_path_or_id` parameters to transaction or slow SQL traces.
  </Collapser>

</CollapserGroup>

## Disabling [#disabling]

Use these settings to toggle instrumentation types during agent startup.

<CollapserGroup>

  <Collapser id="disable_action_cable_instrumentation" title="disable_action_cable_instrumentation">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTION_CABLE_INSTRUMENTATION`</td></tr>
      </tbody>
    </table>

  If `true`, disables Action Cable instrumentation.
  </Collapser>

  <Collapser id="disable_action_controller" title="disable_action_controller">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTION_CONTROLLER`</td></tr>
      </tbody>
    </table>

  If `true`, disables Action Controller instrumentation.
  </Collapser>

  <Collapser id="disable_action_mailbox" title="disable_action_mailbox">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTION_MAILBOX`</td></tr>
      </tbody>
    </table>

  If `true`, disables Action Mailbox instrumentation.
  </Collapser>

  <Collapser id="disable_action_mailer" title="disable_action_mailer">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTION_MAILER`</td></tr>
      </tbody>
    </table>

  If `true`, disables Action Mailer instrumentation.
  </Collapser>

  <Collapser id="disable_activejob" title="disable_activejob">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTIVEJOB`</td></tr>
      </tbody>
    </table>

  If `true`, disables Active Job instrumentation.
  </Collapser>

  <Collapser id="disable_active_storage" title="disable_active_storage">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTIVE_STORAGE`</td></tr>
      </tbody>
    </table>

  If `true`, disables Active Storage instrumentation.
  </Collapser>

  <Collapser id="disable_active_support" title="disable_active_support">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTIVE_SUPPORT`</td></tr>
      </tbody>
    </table>

  If `true`, disables Active Support instrumentation.
  </Collapser>

  <Collapser id="disable_active_record_instrumentation" title="disable_active_record_instrumentation">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTIVE_RECORD_INSTRUMENTATION`</td></tr>
      </tbody>
    </table>

  If `true`, disables Active Record instrumentation.
  </Collapser>

  <Collapser id="disable_active_record_notifications" title="disable_active_record_notifications">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_ACTIVE_RECORD_NOTIFICATIONS`</td></tr>
      </tbody>
    </table>

  If `true`, disables instrumentation for Active Record 4+
  </Collapser>

  <Collapser id="disable_cpu_sampler" title="disable_cpu_sampler">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_CPU_SAMPLER`</td></tr>
      </tbody>
    </table>

  If `true`, the agent won't sample the CPU usage of the host process.
  </Collapser>

  <Collapser id="disable_delayed_job_sampler" title="disable_delayed_job_sampler">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_DELAYED_JOB_SAMPLER`</td></tr>
      </tbody>
    </table>

  If `true`, the agent won't measure the depth of Delayed Job queues.
  </Collapser>

  <Collapser id="disable_gc_profiler" title="disable_gc_profiler">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_GC_PROFILER`</td></tr>
      </tbody>
    </table>

  If `true`, disables the use of `GC::Profiler` to measure time spent in garbage collection
  </Collapser>

  <Collapser id="disable_memory_sampler" title="disable_memory_sampler">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_MEMORY_SAMPLER`</td></tr>
      </tbody>
    </table>

  If `true`, the agent won't sample the memory usage of the host process.
  </Collapser>

  <Collapser id="disable_middleware_instrumentation" title="disable_middleware_instrumentation">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_MIDDLEWARE_INSTRUMENTATION`</td></tr>
      </tbody>
    </table>

  If `true`, the agent won't wrap third-party middlewares in instrumentation (regardless of whether they are installed via `Rack::Builder` or Rails).
  </Collapser>

  <Collapser id="disable_samplers" title="disable_samplers">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_SAMPLERS`</td></tr>
      </tbody>
    </table>

  If `true`, disables the collection of sampler metrics. Sampler metrics are metrics that are not event-based (such as CPU time or memory usage).
  </Collapser>

  <Collapser id="disable_sequel_instrumentation" title="disable_sequel_instrumentation">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_SEQUEL_INSTRUMENTATION`</td></tr>
      </tbody>
    </table>

  If `true`, disables [Sequel instrumentation](/docs/agents/ruby-agent/frameworks/sequel-instrumentation).
  </Collapser>

  <Collapser id="disable_sidekiq" title="disable_sidekiq">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_SIDEKIQ`</td></tr>
      </tbody>
    </table>

  If `true`, disables [Sidekiq instrumentation](/docs/agents/ruby-agent/background-jobs/sidekiq-instrumentation).
  </Collapser>

  <Collapser id="disable_sinatra_auto_middleware" title="disable_sinatra_auto_middleware">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_SINATRA_AUTO_MIDDLEWARE`</td></tr>
      </tbody>
    </table>

  If `true`, disables agent middleware for Sinatra. This middleware is responsible for advanced feature support such as [cross application tracing](/docs/apm/transactions/cross-application-traces/cross-application-tracing), [page load timing](/docs/browser/new-relic-browser/getting-started/new-relic-browser), and [error collection](/docs/apm/applications-menu/events/view-apm-error-analytics).

    <Callout variant="important">
      Cross application tracing is deprecated in favor of [distributed tracing](/docs/apm/distributed-tracing/getting-started/introduction-distributed-tracing). Distributed tracing is on by default for Ruby agent versions 8.0.0 and above. Middlewares are not required to support distributed tracing.

      To continue using cross application tracing, update the following options in your `newrelic.yml` configuration file:

      ```yaml
      # newrelic.yml

        cross_application_tracer:
          enabled: true
        distributed_tracing:
          enabled: false
      ```
    </Callout>

  </Collapser>

  <Collapser id="disable_view_instrumentation" title="disable_view_instrumentation">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_VIEW_INSTRUMENTATION`</td></tr>
      </tbody>
    </table>

  If `true`, disables view instrumentation.
  </Collapser>

  <Collapser id="disable_vm_sampler" title="disable_vm_sampler">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISABLE_VM_SAMPLER`</td></tr>
      </tbody>
    </table>

  If `true`, the agent won't [sample performance measurements from the Ruby VM](/docs/agents/ruby-agent/features/ruby-vm-measurements).
  </Collapser>

</CollapserGroup>

## Distributed Tracing [#distributed-tracing]



<CollapserGroup>

  <Collapser id="distributed_tracing-enabled" title="distributed_tracing.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_DISTRIBUTED_TRACING_ENABLED`</td></tr>
      </tbody>
    </table>

  Distributed tracing lets you see the path that a request takes through your distributed system. Enabling distributed tracing changes the behavior of some New Relic features, so carefully consult the [transition guide](/docs/transition-guide-distributed-tracing) before you enable this feature.
  </Collapser>

</CollapserGroup>

## Elasticsearch [#elasticsearch]



<CollapserGroup>

  <Collapser id="elasticsearch-capture_queries" title="elasticsearch.capture_queries">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ELASTICSEARCH_CAPTURE_QUERIES`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures Elasticsearch queries in transaction traces.
  </Collapser>

  <Collapser id="elasticsearch-obfuscate_queries" title="elasticsearch.obfuscate_queries">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_ELASTICSEARCH_OBFUSCATE_QUERIES`</td></tr>
      </tbody>
    </table>

  If `true`, the agent obfuscates Elasticsearch queries in transaction traces.
  </Collapser>

</CollapserGroup>

## Heroku [#heroku]



<CollapserGroup>

  <Collapser id="heroku-use_dyno_names" title="heroku.use_dyno_names">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_HEROKU_USE_DYNO_NAMES`</td></tr>
      </tbody>
    </table>

  If `true`, the agent uses Heroku dyno names as the hostname.
  </Collapser>

  <Collapser id="heroku-dyno_name_prefixes_to_shorten" title="heroku.dyno_name_prefixes_to_shorten">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`["scheduler", "run"]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_HEROKU_DYNO_NAME_PREFIXES_TO_SHORTEN`</td></tr>
      </tbody>
    </table>

  Ordinarily the agent reports dyno names with a trailing dot and process ID (for example, `worker.3`). You can remove this trailing data by specifying the prefixes you want to report without trailing data (for example, `worker`).
  </Collapser>

</CollapserGroup>

## Infinite Tracing [#infinite-tracing]



<CollapserGroup>

  <Collapser id="infinite_tracing-trace_observer-host" title="infinite_tracing.trace_observer.host">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_HOST`</td></tr>
      </tbody>
    </table>

  Configures the hostname for the trace observer Host. When configured, enables tail-based sampling by sending all recorded spans to a trace observer for further sampling decisions, irrespective of any usual agent sampling decision.
  </Collapser>

  <Collapser id="infinite_tracing-trace_observer-port" title="infinite_tracing.trace_observer.port">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`443`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INFINITE_TRACING_TRACE_OBSERVER_PORT`</td></tr>
      </tbody>
    </table>

  Configures the TCP/IP port for the trace observer Host
  </Collapser>

  <Collapser id="infinite_tracing-batching" title="infinite_tracing.batching">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INFINITE_TRACING_BATCHING`</td></tr>
      </tbody>
    </table>

  If `true` (the default), data sent to the trace observer is batched instead of sending each span individually.
  </Collapser>

  <Collapser id="infinite_tracing-compression_level" title="infinite_tracing.compression_level">
    <table>
      <tbody>
        <tr><th>Type</th><td>Symbol</td></tr>
        <tr><th>Default</th><td>`:high`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INFINITE_TRACING_COMPRESSION_LEVEL`</td></tr>
      </tbody>
    </table>

  Configure the compression level for data sent to the trace observer.

  May be one of: `:none`, `:low`, `:medium`, `:high`.

  Set the level to `:none` to disable compression.

  </Collapser>

</CollapserGroup>

## Instrumentation [#instrumentation]



<CollapserGroup>

  <Collapser id="instrumentation-active_support_logger" title="instrumentation.active_support_logger">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_ACTIVE_SUPPORT_LOGGER`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of `ActiveSupport::Logger` at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-bunny" title="instrumentation.bunny">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_BUNNY`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of bunny at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-fiber" title="instrumentation.fiber">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_FIBER`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of the Fiber class at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-concurrent_ruby" title="instrumentation.concurrent_ruby">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_CONCURRENT_RUBY`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of the concurrent-ruby library at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-curb" title="instrumentation.curb">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_CURB`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Curb at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-delayed_job" title="instrumentation.delayed_job">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_DELAYED_JOB`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Delayed Job at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-elasticsearch" title="instrumentation.elasticsearch">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_ELASTICSEARCH`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of the elasticsearch library at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-excon" title="instrumentation.excon">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`enabled`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_EXCON`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Excon at start up. May be one of: `enabled`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-grape" title="instrumentation.grape">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_GRAPE`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Grape at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-grpc_client" title="instrumentation.grpc_client">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_GRPC_CLIENT`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of gRPC clients at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-grpc-host_denylist" title="instrumentation.grpc.host_denylist">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_GRPC_HOST_DENYLIST`</td></tr>
      </tbody>
    </table>

  Specifies a list of hostname patterns separated by commas that will match gRPC hostnames that traffic is to be ignored by New Relic for. New Relic's gRPC client instrumentation will ignore traffic streamed to a host matching any of these patterns, and New Relic's gRPC server instrumentation will ignore traffic for a server running on a host whose hostname matches any of these patterns. By default, no traffic is ignored when gRPC instrumentation is itself enabled. For example, `"private.com$,exception.*"`
  </Collapser>

  <Collapser id="instrumentation-grpc_server" title="instrumentation.grpc_server">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_GRPC_SERVER`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of gRPC servers at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-httpclient" title="instrumentation.httpclient">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_HTTPCLIENT`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of HTTPClient at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-httprb" title="instrumentation.httprb">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_HTTPRB`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of http.rb gem at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-logger" title="instrumentation.logger">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_LOGGER`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Ruby standard library Logger at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-memcache" title="instrumentation.memcache">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_MEMCACHE`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of dalli gem for Memcache at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-memcached" title="instrumentation.memcached">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_MEMCACHED`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of memcached gem for Memcache at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-memcache_client" title="instrumentation.memcache_client">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_MEMCACHE_CLIENT`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of memcache-client gem for Memcache at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-mongo" title="instrumentation.mongo">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`enabled`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_MONGO`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Mongo at start up. May be one of: `enabled`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-net_http" title="instrumentation.net_http">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_NET_HTTP`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of `Net::HTTP` at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-puma_rack" title="instrumentation.puma_rack">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_PUMA_RACK`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of `Puma::Rack`. When enabled, the agent hooks into the `to_app` method in `Puma::Rack::Builder` to find gems to instrument during application startup. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-puma_rack_urlmap" title="instrumentation.puma_rack_urlmap">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_PUMA_RACK_URLMAP`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of `Puma::Rack::URLMap` at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-rack" title="instrumentation.rack">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_RACK`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Rack. When enabled, the agent hooks into the `to_app` method in `Rack::Builder` to find gems to instrument during application startup. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-rack_urlmap" title="instrumentation.rack_urlmap">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_RACK_URLMAP`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of `Rack::URLMap` at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-rake" title="instrumentation.rake">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_RAKE`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of rake at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-redis" title="instrumentation.redis">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_REDIS`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Redis at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-resque" title="instrumentation.resque">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_RESQUE`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of resque at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-sinatra" title="instrumentation.sinatra">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_SINATRA`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Sinatra at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-thread" title="instrumentation.thread">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_THREAD`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of the Thread class at start up to allow the agent to correctly nest spans inside of an asynchronous transaction. This does not enable the agent to automatically trace all threads created (see `instrumentation.thread.tracing`). May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-thread-tracing" title="instrumentation.thread.tracing">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_THREAD_TRACING`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of the Thread class at start up to automatically add tracing to all Threads created in the application.
  </Collapser>

  <Collapser id="instrumentation-tilt" title="instrumentation.tilt">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`"auto"`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_TILT`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of the Tilt template rendering library at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

  <Collapser id="instrumentation-typhoeus" title="instrumentation.typhoeus">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`auto`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_INSTRUMENTATION_TYPHOEUS`</td></tr>
      </tbody>
    </table>

  Controls auto-instrumentation of Typhoeus at start up. May be one of: `auto`, `prepend`, `chain`, `disabled`.
  </Collapser>

</CollapserGroup>

## Message Tracer [#message-tracer]



<CollapserGroup>

  <Collapser id="message_tracer-segment_parameters-enabled" title="message_tracer.segment_parameters.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_MESSAGE_TRACER_SEGMENT_PARAMETERS_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent will collect metadata about messages and attach them as segment parameters.
  </Collapser>

</CollapserGroup>

## Mongo [#mongo]



<CollapserGroup>

  <Collapser id="mongo-capture_queries" title="mongo.capture_queries">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_MONGO_CAPTURE_QUERIES`</td></tr>
      </tbody>
    </table>

  If `true`, the agent captures Mongo queries in transaction traces.
  </Collapser>

  <Collapser id="mongo-obfuscate_queries" title="mongo.obfuscate_queries">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_MONGO_OBFUSCATE_QUERIES`</td></tr>
      </tbody>
    </table>

  If `true`, the agent obfuscates Mongo queries in transaction traces.
  </Collapser>

</CollapserGroup>

## Process Host [#process-host]



<CollapserGroup>

  <Collapser id="process_host-display_name" title="process_host.display_name">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`(Dynamic)`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_PROCESS_HOST_DISPLAY_NAME`</td></tr>
      </tbody>
    </table>

  Specify a custom host name for [display in the New Relic UI](/docs/apm/new-relic-apm/maintenance/add-rename-remove-hosts#display_name).
  </Collapser>

</CollapserGroup>

## Rake [#rake]



<CollapserGroup>

  <Collapser id="rake-tasks" title="rake.tasks">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_RAKE_TASKS`</td></tr>
      </tbody>
    </table>

  Specify an Array of Rake tasks to automatically instrument. This configuration option converts the Array to a RegEx list. If you'd like to allow all tasks by default, use `rake.tasks: [.+]`. No rake tasks will be instrumented unless they're added to this list. For more information, visit the [New Relic Rake Instrumentation docs](/docs/apm/agents/ruby-agent/background-jobs/rake-instrumentation).
  </Collapser>

  <Collapser id="rake-connect_timeout" title="rake.connect_timeout">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`10`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_RAKE_CONNECT_TIMEOUT`</td></tr>
      </tbody>
    </table>

  Timeout for waiting on connect to complete before a rake task
  </Collapser>

</CollapserGroup>

## Rules [#rules]



<CollapserGroup>

  <Collapser id="rules-ignore_url_regexes" title="rules.ignore_url_regexes">
    <table>
      <tbody>
        <tr><th>Type</th><td>Array</td></tr>
        <tr><th>Default</th><td>`[]`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_RULES_IGNORE_URL_REGEXES`</td></tr>
      </tbody>
    </table>

  Define transactions you want the agent to ignore, by specifying a list of patterns matching the URI you want to ignore. For more detail, see [the docs on ignoring specific transactions](/docs/agents/ruby-agent/api-guides/ignoring-specific-transactions/#config-ignoring).
  </Collapser>

</CollapserGroup>

## Slow SQL [#slow-sql]



<CollapserGroup>

  <Collapser id="slow_sql-enabled" title="slow_sql.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SLOW_SQL_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent collects [slow SQL queries](/docs/apm/applications-menu/monitoring/viewing-slow-query-details).
  </Collapser>

  <Collapser id="slow_sql-explain_threshold" title="slow_sql.explain_threshold">
    <table>
      <tbody>
        <tr><th>Type</th><td>Float</td></tr>
        <tr><th>Default</th><td>`0.5`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SLOW_SQL_EXPLAIN_THRESHOLD`</td></tr>
      </tbody>
    </table>

  Specify a threshold in seconds. The agent collects [slow SQL queries](/docs/apm/applications-menu/monitoring/viewing-slow-query-details) and explain plans that exceed this threshold.
  </Collapser>

  <Collapser id="slow_sql-explain_enabled" title="slow_sql.explain_enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SLOW_SQL_EXPLAIN_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, the agent collects explain plans in slow SQL queries. If this setting is omitted, the [`transaction_tracer.explain_enabled`](#transaction_tracer-explain_enabled) setting will be applied as the default setting for explain plans in slow SQL as well.
  </Collapser>

  <Collapser id="slow_sql-record_sql" title="slow_sql.record_sql">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`obfuscated`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SLOW_SQL_RECORD_SQL`</td></tr>
      </tbody>
    </table>

  Defines an obfuscation level for slow SQL queries. Valid options are `obfuscated`, `raw`, or `none`.
  </Collapser>

  <Collapser id="slow_sql-use_longer_sql_id" title="slow_sql.use_longer_sql_id">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SLOW_SQL_USE_LONGER_SQL_ID`</td></tr>
      </tbody>
    </table>

  Generate a longer `sql_id` for slow SQL traces. `sql_id` is used for aggregation of similar queries.
  </Collapser>

</CollapserGroup>

## Span Events [#span-events]



<CollapserGroup>

  <Collapser id="span_events-enabled" title="span_events.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SPAN_EVENTS_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables span event sampling.
  </Collapser>

  <Collapser id="span_events-queue_size" title="span_events.queue_size">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`10000`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SPAN_EVENTS_QUEUE_SIZE`</td></tr>
      </tbody>
    </table>

  Sets the maximum number of span events to buffer when streaming to the trace observer.
  </Collapser>

  <Collapser id="span_events-max_samples_stored" title="span_events.max_samples_stored">
    <table>
      <tbody>
        <tr><th>Type</th><td>Integer</td></tr>
        <tr><th>Default</th><td>`2000`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_SPAN_EVENTS_MAX_SAMPLES_STORED`</td></tr>
      </tbody>
    </table>

  Defines the maximum number of span events reported from a single harvest. Any Integer between `1` and `10000` is valid.
  </Collapser>

</CollapserGroup>

## Strip Exception Messages [#strip-exception-messages]



<CollapserGroup>

  <Collapser id="strip_exception_messages-enabled" title="strip_exception_messages.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_STRIP_EXCEPTION_MESSAGES_ENABLED`</td></tr>
      </tbody>
    </table>

  If true, the agent strips messages from all exceptions except those in the [allowlist](#strip_exception_messages-allowlist). Enabled automatically in [high security mode](/docs/accounts-partnerships/accounts/security/high-security).
  </Collapser>

  <Collapser id="strip_exception_messages-allowed_classes" title="strip_exception_messages.allowed_classes">
    <table>
      <tbody>
        <tr><th>Type</th><td>String</td></tr>
        <tr><th>Default</th><td>`""`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_STRIP_EXCEPTION_MESSAGES_ALLOWED_CLASSES`</td></tr>
      </tbody>
    </table>

  Specify a list of exceptions you do not want the agent to strip when [strip_exception_messages](#strip_exception_messages-enabled) is `true`. Separate exceptions with a comma. For example, `"ImportantException,PreserveMessageException"`.
  </Collapser>

</CollapserGroup>

## Thread Profiler [#thread-profiler]



<CollapserGroup>

  <Collapser id="thread_profiler-enabled" title="thread_profiler.enabled">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`false`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_THREAD_PROFILER_ENABLED`</td></tr>
      </tbody>
    </table>

  If `true`, enables use of the [thread profiler](/docs/apm/applications-menu/events/thread-profiler-tool).
  </Collapser>

</CollapserGroup>

## Utilization [#utilization]



<CollapserGroup>

  <Collapser id="utilization-detect_aws" title="utilization.detect_aws">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_UTILIZATION_DETECT_AWS`</td></tr>
      </tbody>
    </table>

  If `true`, the agent automatically detects that it is running in an AWS environment.
  </Collapser>

  <Collapser id="utilization-detect_azure" title="utilization.detect_azure">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_UTILIZATION_DETECT_AZURE`</td></tr>
      </tbody>
    </table>

  If `true`, the agent automatically detects that it is running in an Azure environment.
  </Collapser>

  <Collapser id="utilization-detect_docker" title="utilization.detect_docker">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_UTILIZATION_DETECT_DOCKER`</td></tr>
      </tbody>
    </table>

  If `true`, the agent automatically detects that it is running in Docker.
  </Collapser>

  <Collapser id="utilization-detect_gcp" title="utilization.detect_gcp">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_UTILIZATION_DETECT_GCP`</td></tr>
      </tbody>
    </table>

  If `true`, the agent automatically detects that it is running in an Google Cloud Platform environment.
  </Collapser>

  <Collapser id="utilization-detect_kubernetes" title="utilization.detect_kubernetes">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_UTILIZATION_DETECT_KUBERNETES`</td></tr>
      </tbody>
    </table>

  If `true`, the agent automatically detects that it is running in Kubernetes.
  </Collapser>

  <Collapser id="utilization-detect_pcf" title="utilization.detect_pcf">
    <table>
      <tbody>
        <tr><th>Type</th><td>Boolean</td></tr>
        <tr><th>Default</th><td>`true`</td></tr>
        <tr><th>Environ variable</th><td>`NEW_RELIC_UTILIZATION_DETECT_PCF`</td></tr>
      </tbody>
    </table>

  If `true`, the agent automatically detects that it is running in a Pivotal Cloud Foundry environment.
  </Collapser>

</CollapserGroup>